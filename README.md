# TODO‑планировщик на Go

## Описание проекта

Веб‑сервер, реализующий функциональность планировщика задач (аналог TODO‑листа).

**Основные возможности:**
* хранение задач с датой дедлайна, заголовком и комментарием;
* поддержка повторяющихся задач с различными правилами повторения;
* API для управления задачами (добавление, получение списка, удаление, изменение, отметка как выполненной).

**Правила повторения задач:**
* `d <число>` - задача переносится на указанное число дней. Максимально допустимое число - 400;
* `y` - задача выполняется ежегодно. При выполнении дата переносится на год вперёд;
* `w<дни недели через запятую>` - дни недели задаются числами от 1 (понедельник) до 7 (воскресенье);
* `m<дни месяца через запятую>[<месяцы через запятую>]` - дни месяца задаются числами от 1 до 31, а также -1 и -2; месяцы - числами от 1 до 12.

**Дополнительные функции:**
* поиск задач по тексту (в заголовке или комментарии);
* фильтрация задач по дате (формат `02.01.2006`);
* базовая аутентификация по паролю (из переменной окружения).

## Структура проекта

Проект организован следующим образом: 

  - `main.go` - точка входа в приложение, инициализация сервера и зависимостей.

- `internal/`  
  - `api/` - HTTP‑обработчики API.    
  - `db/` - работа с базой данных.  
  - `server/` - бизнес‑логика (обработка задач, правил повторения).  
  - `services/` - бизнес‑логика (обработка задач, правил повторения).  

- `tests/`  
  - Юнит‑тесты и интеграционные тесты.  
  - `settings.go` - конфигурация для тестов.

- `web/`  
  - Директория с файлами фронтенда.

- `Dockerfile` - инструкция для сборки Docker‑образа.

- `.env.example` - шаблон файла переменных окружения.

- `go.mod`, `go.sum` - зависимости Go.

- `README.md` - текущая документация.

## Выполненные задания повышенной трудности


* Настройка порта сервера через переменную окружения `TODO_PORT`.
* Настройка пути к файлу базы данных через переменную окружения `TODO_DBFILE`.
* Реализация правила повторения задач `w` (дни недели).
* Реализация правила повторения задач `m` (дни месяца с опциональной фильтрацией по месяцам).
* Реализация поиска и фильтрации задач через параметр `search` в API.
* Создание Docker‑образа для запуска веб‑сервера.
* Реализация базовой аутентификации через переменную окружения `TODO_PASSWORD`.


## Запуск проекта локально

### Предварительные требования

* Установленный Go (версия ≥ 1.25).

### Инструкция

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/Shilan42/your-project.git
   cd your-project
   ```

2. Установите зависимости:
   ```bash
   go mod download
   ```

3. Настройте окружение. Выберите один из способов:

   **Способ 1. Через переменные оболочки**  
   Задайте переменные в текущей сессии:
   ```bash
   export TODO_PASSWORD=012345
   export JWT_SECRET=bobr
   ```

   **Способ 2. Через файл `.env`**  
   - Создайте файл `.env` в корневой директории проекта.  
   - Добавьте переменные в формате `КЛЮЧ=значение`:
     ```bash
     TODO_PASSWORD=012345
     JWT_SECRET=bobr
     ```
   - Убедитесь, что файл не попадает в репозиторий (добавьте `.env` в `.gitignore`).

4. Запустите проект:
   ```bash
   go run main.go
   ```

### Адрес для браузера

После запуска откройте в браузере:  
`http://localhost:7540`

## Запуск тестов

### Предварительные требования

* Установленный Go.

### Инструкция

1. Перейдите в директорию с тестами:
   ```bash
   cd tests
   ```

2. Запустите тесты:
   ```bash
   go test -v ./...
   ```

   Либо выполните команду из корневой директории:
   ```bash
   go test ./tests
   ```

### Параметры в `tests/settings.go`

В файле `tests/settings.go` можно настроить следующие параметры:

* `FullNextDate` (`true`/`false`) - если реализована поддержка всех вариантов правил повторения, установите значение `true`;
* `Search` (`true`/`false`) - для тестирования поиска задачи через поисковую строку (проверка наличия строки поиска в заголовке или комментарии задач);
* `Token` - для запуска тестов `go test ./tests` для веб‑сервера с поддержкой аутентификации.


## Сборка и запуск через Docker

### Предварительные требования

* Установленный Docker.

### Инструкция

1. Соберите образ:
   ```bash
   docker build -t go-task-manager .
   ```

2. Запустите контейнер с полностью кастомными параметрами:
   ```bash
   docker run -p 7540:7540 \
     -e TODO_PORT=7540 \
     -e TODO_DBFILE=/app/scheduler.db \
     -e TODO_PASSWORD=012345 \
     -e JWT_SECRET=bobr \
     go-task-manager
   ```

3. Запустите контейнер с частичным переопределением (рекомендуется):
   ```bash
   docker run -p 7540:7540 \
     -e TODO_PASSWORD=012345 \
     -e JWT_SECRET=bobr \
     go-task-manager
   ```

4. Проверьте работу: откройте в браузере `http://localhost:7540`.

## Контакты

По вопросам и предложениям обращайтесь:

* **Email:** `a.v.shilenkov@yandex.ru`  
* **GitHub:** [https://github.com/Shilan42](https://github.com/Shilan42)